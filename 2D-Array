import com.lowagie.text.*;
import com.lowagie.text.pdf.*;
import org.springframework.stereotype.Service;

import java.awt.Color;
import java.io.ByteArrayInputStream;
import java.io.ByteArrayOutputStream;

@Service
public class PdfService {

    public ByteArrayInputStream generateWaybillPdf() {
        Document document = new Document(PageSize.A4, 36, 36, 36, 36);
        ByteArrayOutputStream out = new ByteArrayOutputStream();

        try {
            PdfWriter writer = PdfWriter.getInstance(document, out);
            document.open();

            // ========== HEADER ==========
            PdfPTable headerTable = new PdfPTable(2);
            headerTable.setWidthPercentage(100);
            headerTable.setWidths(new int[]{70, 30});

            // SAFEXPRESS logo (placeholder text for now)
            Font logoFont = new Font(Font.HELVETICA, 14, Font.BOLD, Color.BLACK);
            PdfPCell logoCell = new PdfPCell(new Phrase("SAFEXPRESS\nDistribution Redefined", logoFont));
            logoCell.setBorder(Rectangle.NO_BORDER);
            logoCell.setHorizontalAlignment(Element.ALIGN_LEFT);
            headerTable.addCell(logoCell);

            // Delivered stamp (green)
            Font deliveredFont = new Font(Font.HELVETICA, 16, Font.BOLD, Color.GREEN);
            PdfPCell deliveredCell = new PdfPCell(new Phrase("DELIVERED", deliveredFont));
            deliveredCell.setBorder(Rectangle.NO_BORDER);
            deliveredCell.setHorizontalAlignment(Element.ALIGN_RIGHT);
            headerTable.addCell(deliveredCell);

            document.add(headerTable);
            document.add(new Paragraph(" "));

            // ========== WAYBILL INFO ==========
            PdfPTable infoTable = new PdfPTable(2);
            infoTable.setWidthPercentage(100);

            addInfoCell(infoTable, "Waybill No:", "1000 1824 2559");
            addInfoCell(infoTable, "Booking Branch:", "DELHI-15");
            addInfoCell(infoTable, "Pickup Date:", "11-JUN-2025");
            addInfoCell(infoTable, "Delivery Gateway:", "NAGPUR-11");
            addInfoCell(infoTable, "Destination Pincode:", "440005");
            addInfoCell(infoTable, "Ship Date:", "12-JUN-2025");

            document.add(infoTable);
            document.add(new Paragraph(" "));

            // Barcode for Waybill
            Barcode128 barcode = new Barcode128();
            barcode.setCode("100018242559");
            Image barcodeImage = barcode.createImageWithBarcode(writer.getDirectContent(), null, null);
            barcodeImage.scalePercent(100);
            document.add(barcodeImage);

            document.add(new Paragraph(" "));

            // ========== CONSIGNOR ==========
            Font sectionFont = new Font(Font.HELVETICA, 12, Font.BOLD);
            document.add(new Paragraph("Consignor Name:", sectionFont));
            document.add(new Paragraph("JK FENNER (INDIA) LTD (NON VMI)"));
            document.add(new Paragraph("Building No. 176/8, Ground Floor, M.G Road, Sector 83, Delhi, 110045"));
            document.add(new Paragraph(" "));

            // ========== CONSIGNEE ==========
            document.add(new Paragraph("Consignee Name:", sectionFont));
            document.add(new Paragraph("LOGITEC INFRO INDIA PVT. LTD"));
            document.add(new Paragraph("Sadar Global Market, Gali No.8, Plot No. 17, Sadar Metro Road, Sector 22, Bangalore, Karnataka - 560001"));
            document.add(new Paragraph(" "));

            // ========== PACKAGE INFO ==========
            PdfPTable pkgTable = new PdfPTable(4);
            pkgTable.setWidthPercentage(100);
            pkgTable.setWidths(new int[]{25, 25, 25, 25});

            pkgTable.addCell("No. of Pkg");
            pkgTable.addCell("Actual Weight (kg)");
            pkgTable.addCell("No. of Invoice");
            pkgTable.addCell("Invoice Value");

            pkgTable.addCell("10");
            pkgTable.addCell("250");
            pkgTable.addCell("2");
            pkgTable.addCell("â‚¹16,00,000/-");

            document.add(pkgTable);
            document.add(new Paragraph(" "));

            // Fragile note
            Font fragileFont = new Font(Font.HELVETICA, 11, Font.BOLDITALIC, Color.RED);
            document.add(new Paragraph("Fragile material - Handle with care", fragileFont));

            document.close();
        } catch (Exception e) {
            e.printStackTrace();
        }

        return new ByteArrayInputStream(out.toByteArray());
    }

    private void addInfoCell(PdfPTable table, String key, String value) {
        PdfPCell cell1 = new PdfPCell(new Phrase(key));
        PdfPCell cell2 = new PdfPCell(new Phrase(value));
        cell1.setPadding(5);
        cell2.setPadding(5);
        table.addCell(cell1);
        table.addCell(cell2);
    }
}
====
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.HttpHeaders;
import org.springframework.http.MediaType;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RestController;

import java.io.ByteArrayInputStream;

@RestController
public class PdfController {

    @Autowired
    private PdfService pdfService;

    @GetMapping("/waybill/pdf")
    public ResponseEntity<byte[]> downloadPdf() throws Exception {
        ByteArrayInputStream bis = pdfService.generateWaybillPdf();

        return ResponseEntity.ok()
                .header(HttpHeaders.CONTENT_DISPOSITION, "attachment; filename=waybill.pdf")
                .contentType(MediaType.APPLICATION_PDF)
                .body(bis.readAllBytes());
    }
}